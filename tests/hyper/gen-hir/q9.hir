module default{
  import Builtin.*;
  def main() : table{
    t0:? = @load_table(`nation:sym);
    t2:sym = check_cast(@column_value(t0,`n_name:sym), sym);
    t5:? = @load_table(`supplier:sym);
    t6:i32 = check_cast(@column_value(t5,`s_suppkey:sym), i32);
    t9:enum<i32> = check_cast(@column_value(t5,`s_nationkey:sym), enum<i32>);
    t13:? = @values(t9);
    t15:? = @index(t2,t13);
    t19:? = @load_table(`part:sym);
    t20:i32 = check_cast(@column_value(t19,`p_partkey:sym), i32);
    t21:sym = check_cast(@column_value(t19,`p_name:sym), sym);
    t29:? = @like(t21,`"%green%":sym);
    t39:? = @load_table(`partsupp:sym);
    t40:enum<i32> = check_cast(@column_value(t39,`ps_partkey:sym), enum<i32>);
    t41:enum<i32> = check_cast(@column_value(t39,`ps_suppkey:sym), enum<i32>);
    t43:f64 = check_cast(@column_value(t39,`ps_supplycost:sym), f64);
    t45:? = @values(t40);
    t46:? = @index(t29,t45);
    t47:? = @compress(t46,t45);
    t48:? = @where(t46);
    t49:? = @index(t20,t47);
    t58:? = @fetch(t40);
    t59:? = @index(t58,t48);
    t60:? = @fetch(t41);
    t61:? = @index(t60,t48);
    t63:? = @index(t43,t48);
    t65:? = @join_index(@eq,t6,t61);
    t66:? = @index(t65,0:i64);
    t67:? = @index(t65,1:i64);
    t69:? = @index(t15,t66);
    t72:? = @index(t6,t66);
    t80:? = @index(t49,t67);
    t89:? = @index(t59,t67);
    t90:? = @index(t61,t67);
    t92:? = @index(t63,t67);
    t94:? = @load_table(`lineitem:sym);
    t95:enum<i32> = check_cast(@column_value(t94,`l_orderkey:sym), enum<i32>);
    t96:i32 = check_cast(@column_value(t94,`l_partkey:sym), i32);
    t97:i32 = check_cast(@column_value(t94,`l_suppkey:sym), i32);
    t99:f64 = check_cast(@column_value(t94,`l_quantity:sym), f64);
    t100:f64 = check_cast(@column_value(t94,`l_extendedprice:sym), f64);
    t101:f64 = check_cast(@column_value(t94,`l_discount:sym), f64);
    t111:? = @list(t90,t89,t80,t72);
    t112:? = @list(t97,t96,t96,t97);
    t113:? = @join_index(@eq,t111,t112);
    t114:? = @index(t113,0:i64);
    t115:? = @index(t113,1:i64);
    t117:? = @index(t69,t114);
    t139:? = @index(t92,t114);
    t141:? = @fetch(t95);
    t142:? = @index(t141,t115);
    t146:? = @index(t99,t115);
    t147:? = @index(t100,t115);
    t148:? = @index(t101,t115);
    t158:? = @load_table(`orders:sym);
    t159:i32 = check_cast(@column_value(t158,`o_orderkey:sym), i32);
    t163:date = check_cast(@column_value(t158,`o_orderdate:sym), date);
    t168:? = @join_index(@eq,t159,t142);
    t169:? = @index(t168,0:i64);
    t170:? = @index(t168,1:i64);
    t172:? = @index(t117,t170);
    t194:? = @index(t139,t170);
    t200:? = @index(t146,t170);
    t201:? = @index(t147,t170);
    t202:? = @index(t148,t170);
    t217:? = @index(t163,t169);
    t222:? = @date_year(t217);
    t223:? = @mul(t194,t200);
    t224:? = @minus(1:i32,t202);
    t225:? = @mul(t201,t224);
    t226:? = @minus(t225,t223);
    t227:? = @list(t172,t222);
    t228:? = @group(t227);
    t229:? = @keys(t228);
    t230:? = @values(t228);
    t231:? = @index(t172,t229);
    t232:? = @index(t222,t229);
    t233:? = @each_right(@index,t226,t230);
    t234:? = @each(@sum,t233);
    t235:? = @raze(t234);
    t236:? = @list(t231,t232);
    t237:? = @order(t236,(1,0):bool);
    t238:? = @index(t231,t237);
    t239:? = @index(t232,t237);
    t240:? = @index(t235,t237);
    t241:? = (`nation,`o_year,`sum_profit):sym;
    t242:? = @list(t238,t239,t240);
    t243:? = @table(t241,t242);
    return t243;
  }
}
// Program slicing (before 250, after 93)
// Elapsed time: 3.99 ms
