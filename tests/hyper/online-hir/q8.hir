module default{
  import Builtin.*;
  def main() : table{
    t0:? = @load_table(`nation:sym);
    t1:i32 = check_cast(@column_value(t0,`n_nationkey:sym), i32);
    t2:sym = check_cast(@column_value(t0,`n_name:sym), sym);
    t5:? = @load_table(`region:sym);
    t7:sym = check_cast(@column_value(t5,`r_name:sym), sym);
    t9:? = @eq(t7,`AMERICA:sym);
    t13:? = @load_table(`nation:sym);
    t14:i32 = check_cast(@column_value(t13,`n_nationkey:sym), i32);
    t16:enum<i32> = check_cast(@column_value(t13,`n_regionkey:sym), enum<i32>);
    t18:? = @values(t16);
    t19:? = @index(t9,t18);
    t21:? = @where(t19);
    t25:? = @index(t14,t21);
    t30:? = @load_table(`part:sym);
    t31:i32 = check_cast(@column_value(t30,`p_partkey:sym), i32);
    t35:sym = check_cast(@column_value(t30,`p_type:sym), sym);
    t40:? = @eq(t35,`"ECONOMY ANODIZED STEEL":sym);
    t41:? = @compress(t40,t31);
    t50:? = @load_table(`lineitem:sym);
    t51:enum<i32> = check_cast(@column_value(t50,`l_orderkey:sym), enum<i32>);
    t52:i32 = check_cast(@column_value(t50,`l_partkey:sym), i32);
    t53:i32 = check_cast(@column_value(t50,`l_suppkey:sym), i32);
    t56:f64 = check_cast(@column_value(t50,`l_extendedprice:sym), f64);
    t57:f64 = check_cast(@column_value(t50,`l_discount:sym), f64);
    t67:? = @join_index(@eq,t41,t52);
    t69:? = @index(t67,1:i64);
    t79:? = @fetch(t51);
    t80:? = @index(t79,t69);
    t82:? = @index(t53,t69);
    t85:? = @index(t56,t69);
    t86:? = @index(t57,t69);
    t96:? = @load_table(`orders:sym);
    t97:i32 = check_cast(@column_value(t96,`o_orderkey:sym), i32);
    t98:enum<i32> = check_cast(@column_value(t96,`o_custkey:sym), enum<i32>);
    t101:date = check_cast(@column_value(t96,`o_orderdate:sym), date);
    t106:? = @geq(t101,1995-01-01:date);
    t107:? = @leq(t101,1996-12-31:date);
    t108:? = @and(t106,t107);
    t109:? = @compress(t108,t97);
    t110:? = @fetch(t98);
    t147:? = @compress(t108,t110);
    //t110:? = @compress(t108,t98);
    t113:? = @compress(t108,t101);
    t118:? = @join_index(@eq,t109,t80);
    t119:? = @index(t118,0:i64);
    t120:? = @index(t118,1:i64);
    t132:? = @index(t82,t120);
    t135:? = @index(t85,t120);
    t136:? = @index(t86,t120);
    //t147:? = @fetch(t110);
    t148:? = @index(t147,t119);
    t151:? = @index(t113,t119);
    t156:? = @load_table(`customer:sym);
    t157:i32 = check_cast(@column_value(t156,`c_custkey:sym), i32);
    t160:enum<i32> = check_cast(@column_value(t156,`c_nationkey:sym), enum<i32>);
    t165:? = @join_index(@eq,t157,t148);
    t166:? = @index(t165,0:i64);
    t167:? = @index(t165,1:i64);
    t179:? = @index(t132,t167);
    t182:? = @index(t135,t167);
    t183:? = @index(t136,t167);
    t197:? = @index(t151,t167);
    t205:? = @fetch(t160);
    t206:? = @index(t205,t166);
    t211:? = @join_index(@eq,t25,t206);
    t213:? = @index(t211,1:i64);
    t232:? = @index(t179,t213);
    t235:? = @index(t182,t213);
    t236:? = @index(t183,t213);
    t250:? = @index(t197,t213);
    t263:? = @load_table(`supplier:sym);
    t264:i32 = check_cast(@column_value(t263,`s_suppkey:sym), i32);
    t267:enum<i32> = check_cast(@column_value(t263,`s_nationkey:sym), enum<i32>);
    t271:? = @join_index(@eq,t264,t232);
    t272:? = @index(t271,0:i64);
    t273:? = @index(t271,1:i64);
    t295:? = @index(t235,t273);
    t296:? = @index(t236,t273);
    t310:? = @index(t250,t273);
    t326:? = @fetch(t267);
    t327:? = @index(t326,t272);
    t331:? = @join_index(@eq,t1,t327);
    t332:? = @index(t331,0:i64);
    t333:? = @index(t331,1:i64);
    t335:? = @index(t2,t332);
    t360:? = @index(t295,t333);
    t361:? = @index(t296,t333);
    t375:? = @index(t310,t333);
    t395:? = @date_year(t375);
    t396:? = @minus(1:i32,t361);
    t397:? = @mul(t360,t396);
    t398:? = @eq(t335,`BRAZIL:sym);
    t399:? = @mul(t398,t397);
    t400:? = @not(t398);
    t401:? = @mul(t400,0:f64);
    t402:? = @plus(t399,t401);
    t403:? = @list(t395);
    t404:? = @group(t403);
    t405:? = @keys(t404);
    t406:? = @values(t404);
    t407:? = @index(t395,t405);
    t408:? = @each_right(@index,t402,t406);
    t409:? = @each(@sum,t408);
    t410:? = @raze(t409);
    t411:? = @each_right(@index,t397,t406);
    t412:? = @each(@sum,t411);
    t413:? = @raze(t412);
    t414:? = @div(t410,t413);
    t415:? = @list(t407);
    t416:? = @order(t415,1:bool);
    t417:? = @index(t407,t416);
    t418:? = @index(t414,t416);
    t419:? = (`o_year,`mkt_share):sym;
    t420:? = @list(t417,t418);
    t421:? = @table(t419,t420);
    return t421;
  }
}
// Program slicing (before 428, after 119)
// Elapsed time: 5.21 ms
