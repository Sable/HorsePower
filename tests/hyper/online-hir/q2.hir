module default{
  import Builtin.*;
  def main() : table{
    t0:? = @load_table(`region:sym);
    t2:sym = check_cast(@column_value(t0,`r_name:sym), sym);
    t4:? = @eq(t2,`EUROPE:sym);
    t8:? = @load_table(`nation:sym);
    t9:i32 = check_cast(@column_value(t8,`n_nationkey:sym), i32);
    t10:sym = check_cast(@column_value(t8,`n_name:sym), sym);
    t11:enum<i32> = check_cast(@column_value(t8,`n_regionkey:sym), enum<i32>);
    t13:? = @values(t11);
    t14:? = @index(t4,t13);
    t16:? = @where(t14);
    t20:? = @index(t9,t16);
    t21:? = @index(t10,t16);
    t25:? = @load_table(`supplier:sym);
    t26:i32 = check_cast(@column_value(t25,`s_suppkey:sym), i32);
    t27:str = check_cast(@column_value(t25,`s_name:sym), str);
    t28:str = check_cast(@column_value(t25,`s_address:sym), str);
    t29:enum<i32> = check_cast(@column_value(t25,`s_nationkey:sym), enum<i32>);
    t30:str = check_cast(@column_value(t25,`s_phone:sym), str);
    t31:f64 = check_cast(@column_value(t25,`s_acctbal:sym), f64);
    t32:str = check_cast(@column_value(t25,`s_comment:sym), str);
    t33:? = @fetch(t29);
    t34:? = @join_index(@eq,t20,t33);
    t35:? = @index(t34,0:i64);
    t36:? = @index(t34,1:i64);
    t41:? = @index(t21,t35);
    t44:? = @index(t26,t36);
    t45:? = @index(t27,t36);
    t46:? = @index(t28,t36);
    t48:? = @index(t30,t36);
    t49:? = @index(t31,t36);
    t50:? = @index(t32,t36);
    t51:? = @load_table(`part:sym);
    t52:i32 = check_cast(@column_value(t51,`p_partkey:sym), i32);
    t54:str = check_cast(@column_value(t51,`p_mfgr:sym), str);
    t56:sym = check_cast(@column_value(t51,`p_type:sym), sym);
    t57:i32 = check_cast(@column_value(t51,`p_size:sym), i32);
    t61:? = @like(t56,`"%BRASS":sym);
    t62:? = @eq(t57,15:i32);
    t63:? = @and(t62,t61);
    t64:? = @compress(t63,t52);
    t66:? = @compress(t63,t54);
    t73:? = @load_table(`region:sym);
    t75:sym = check_cast(@column_value(t73,`r_name:sym), sym);
    t77:? = @eq(t75,`EUROPE:sym);
    t81:? = @load_table(`nation:sym);
    t82:i32 = check_cast(@column_value(t81,`n_nationkey:sym), i32);
    t84:enum<i32> = check_cast(@column_value(t81,`n_regionkey:sym), enum<i32>);
    t86:? = @values(t84);
    t87:? = @index(t77,t86);
    t89:? = @where(t87);
    t93:? = @index(t82,t89);
    t98:? = @load_table(`supplier:sym);
    t99:i32 = check_cast(@column_value(t98,`s_suppkey:sym), i32);
    t102:enum<i32> = check_cast(@column_value(t98,`s_nationkey:sym), enum<i32>);
    t106:? = @fetch(t102);
    t107:? = @join_index(@eq,t93,t106);
    t109:? = @index(t107,1:i64);
    t117:? = @index(t99,t109);
    t130:? = @load_table(`partsupp:sym);
    t131:enum<i32> = check_cast(@column_value(t130,`ps_partkey:sym), enum<i32>);
    t132:enum<i32> = check_cast(@column_value(t130,`ps_suppkey:sym), enum<i32>);
    t134:f64 = check_cast(@column_value(t130,`ps_supplycost:sym), f64);
    t136:? = @fetch(t132);
    t137:? = @join_index(@eq,t117,t136);
    t139:? = @index(t137,1:i64);
    t154:? = @fetch(t131);
    t155:? = @index(t154,t139);
    t158:? = @index(t134,t139);
    t160:? = @list(t155);
    t161:? = @group(t160);
    t162:? = @keys(t161);
    t163:? = @values(t161);
    t164:? = @each_right(@index,t158,t163);
    t165:? = @each(@min,t164);
    t166:? = @raze(t165);
    t167:? = @index(t155,t162);
    t168:? = @join_index(@eq,t64,t167);
    t169:? = @index(t168,0:i64);
    t170:? = @index(t168,1:i64);
    t171:? = @index(t64,t169);
    t173:? = @index(t66,t169);
    t180:? = @index(t166,t170);
    t183:? = @load_table(`partsupp:sym);
    t184:enum<i32> = check_cast(@column_value(t183,`ps_partkey:sym), enum<i32>);
    t185:enum<i32> = check_cast(@column_value(t183,`ps_suppkey:sym), enum<i32>);
    t187:f64 = check_cast(@column_value(t183,`ps_supplycost:sym), f64);
    t189:? = @fetch(t184);
    t190:? = @list(t180,t171);
    t191:? = @list(t187,t189);
    t192:? = @join_index(@eq,t190,t191);
    t193:? = @index(t192,0:i64);
    t194:? = @index(t192,1:i64);
    t195:? = @index(t171,t193);
    t197:? = @index(t173,t193);
    t208:? = @fetch(t185);
    t209:? = @index(t208,t194);
    t213:? = @join_index(@eq,t44,t209);
    t214:? = @index(t213,0:i64);
    t215:? = @index(t213,1:i64);
    t220:? = @index(t41,t214);
    t224:? = @index(t45,t214);
    t225:? = @index(t46,t214);
    t227:? = @index(t48,t214);
    t228:? = @index(t49,t214);
    t229:? = @index(t50,t214);
    t230:? = @index(t195,t215);
    t232:? = @index(t197,t215);
    t247:? = @list(t228,t220,t224,t230);
    t248:? = @order(t247,(0,1,1,1):bool);
    t249:? = @index(t228,t248);
    t250:? = @index(t224,t248);
    t251:? = @index(t220,t248);
    t252:? = @index(t230,t248);
    t253:? = @index(t232,t248);
    t254:? = @index(t225,t248);
    t255:? = @index(t227,t248);
    t256:? = @index(t229,t248);
    t257:? = (`s_acctbal,`s_name,`n_name,`p_partkey,`p_mfgr,`s_address,`s_phone,`s_comment):sym;
    t258:? = @list(t249,t250,t251,t252,t253,t254,t255,t256);
    t259:? = @table(t257,t258);
    return t259;
  }
}
// Program slicing (before 266, after 126)
// Elapsed time: 5.31 ms
