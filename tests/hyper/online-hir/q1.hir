module default{
  import Builtin.*;
  def main() : table{
    t0:? = @load_table(`lineitem:sym);
    t6:f64 = check_cast(@column_value(t0,`l_quantity:sym), f64);
    t7:f64 = check_cast(@column_value(t0,`l_extendedprice:sym), f64);
    t8:f64 = check_cast(@column_value(t0,`l_discount:sym), f64);
    t9:f64 = check_cast(@column_value(t0,`l_tax:sym), f64);
    t10:char = check_cast(@column_value(t0,`l_returnflag:sym), char);
    t11:char = check_cast(@column_value(t0,`l_linestatus:sym), char);
    t12:date = check_cast(@column_value(t0,`l_shipdate:sym), date);
    t18:? = @leq(t12,1998-09-02:date);
    t23:? = @compress(t18,t6);
    t24:? = @compress(t18,t7);
    t25:? = @compress(t18,t8);
    t26:? = @compress(t18,t9);
    t27:? = @compress(t18,t10);
    t28:? = @compress(t18,t11);
    t35:? = @minus(1:i32,t25);
    t36:? = @mul(t24,t35);
    t37:? = @plus(1:i32,t26);
    t38:? = @minus(1:i32,t25);
    t39:? = @mul(t24,t38);
    t40:? = @mul(t39,t37);
    t41:? = @list(t27,t28);
    t42:? = @group(t41);
    t43:? = @keys(t42);
    t44:? = @values(t42);
    t45:? = @index(t27,t43);
    t46:? = @index(t28,t43);
    t47:? = @each_right(@index,t23,t44);
    t48:? = @each(@sum,t47);
    t49:? = @raze(t48);
    t50:? = @each_right(@index,t23,t44);
    t51:? = @each(@avg,t50);
    t52:? = @raze(t51);
    t53:? = @each_right(@index,t24,t44);
    t54:? = @each(@sum,t53);
    t55:? = @raze(t54);
    t56:? = @each_right(@index,t24,t44);
    t57:? = @each(@avg,t56);
    t58:? = @raze(t57);
    t59:? = @each_right(@index,t36,t44);
    t60:? = @each(@sum,t59);
    t61:? = @raze(t60);
    t62:? = @each_right(@index,t40,t44);
    t63:? = @each(@sum,t62);
    t64:? = @raze(t63);
    t68:? = @each_right(@index,t25,t44);
    t69:? = @each(@avg,t68);
    t70:? = @raze(t69);
    t71:? = @each_right(@index,t27,t44);
    t72:? = @each(@len,t71);
    t73:? = @raze(t72);
    t74:? = @list(t45,t46);
    t75:? = @order(t74,(1,1):bool);
    t76:? = @index(t45,t75);
    t77:? = @index(t46,t75);
    t78:? = @index(t49,t75);
    t79:? = @index(t55,t75);
    t80:? = @index(t61,t75);
    t81:? = @index(t64,t75);
    t82:? = @index(t52,t75);
    t83:? = @index(t58,t75);
    t84:? = @index(t70,t75);
    t85:? = @index(t73,t75);
    t86:? = (`l_returnflag,`l_linestatus,`sum_qty,`sum_base_price,`sum_disc_price,`sum_charge,`avg_qty,`avg_price,`avg_disc,`count_order):sym;
    t87:? = @list(t76,t77,t78,t79,t80,t81,t82,t83,t84,t85);
    t88:? = @table(t86,t87);
    return t88;
  }
}
