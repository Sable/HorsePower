module default{
  import Builtin.*;
  def main() : table{
    t0:? = @load_table(`supplier:sym);
    t1:i32 = check_cast(@column_value(t0,`s_suppkey:sym), i32);
    t4:enum<i32> = check_cast(@column_value(t0,`s_nationkey:sym), enum<i32>);
    t8:? = @load_table(`nation:sym);
    t9:i32 = check_cast(@column_value(t8,`n_nationkey:sym), i32);
    t10:sym = check_cast(@column_value(t8,`n_name:sym), sym);
    t13:? = @load_table(`nation:sym);
    t14:i32 = check_cast(@column_value(t13,`n_nationkey:sym), i32);
    t15:sym = check_cast(@column_value(t13,`n_name:sym), sym);
    t18:? = @eq(t10,`GERMANY:sym);
    t19:? = @eq(t15,`FRANCE:sym);
    t20:? = @where(t18);
    t21:? = @where(t19);
    t22:? = @len(t20);
    t23:? = @len(t21);
    t24:? = @vector(t23,t20);
    t25:? = @vector(t22,t21);
    t26:? = @eq(t10,`FRANCE:sym);
    t27:? = @eq(t15,`GERMANY:sym);
    t28:? = @where(t26);
    t29:? = @where(t27);
    t30:? = @len(t28);
    t31:? = @len(t29);
    t32:? = @vector(t31,t28);
    t33:? = @vector(t30,t29);
    t34:? = @append(t24,t32);
    t35:? = @append(t25,t33);
    t36:? = @index(t9,t34);
    t37:? = @index(t10,t34);
    t41:? = @index(t14,t35);
    t42:? = @index(t15,t35);
    t46:? = @load_table(`customer:sym);
    t47:i32 = check_cast(@column_value(t46,`c_custkey:sym), i32);
    t50:enum<i32> = check_cast(@column_value(t46,`c_nationkey:sym), enum<i32>);
    t55:? = @fetch(t50);
    t56:? = @join_index(@eq,t36,t55);
    t57:? = @index(t56,0:i64);
    t58:? = @index(t56,1:i64);
    t60:? = @index(t37,t57);
    t63:? = @index(t41,t57);
    t64:? = @index(t42,t57);
    t67:? = @index(t47,t58);
    t75:? = @load_table(`orders:sym);
    t76:i32 = check_cast(@column_value(t75,`o_orderkey:sym), i32);
    t77:enum<i32> = check_cast(@column_value(t75,`o_custkey:sym), enum<i32>);
    t85:? = @fetch(t77);
    t86:? = @join_index(@eq,t67,t85);
    t87:? = @index(t86,0:i64);
    t88:? = @index(t86,1:i64);
    t90:? = @index(t60,t87);
    t93:? = @index(t63,t87);
    t94:? = @index(t64,t87);
    t105:? = @index(t76,t88);
    t114:? = @load_table(`lineitem:sym);
    t115:enum<i32> = check_cast(@column_value(t114,`l_orderkey:sym), enum<i32>);
    t117:i32 = check_cast(@column_value(t114,`l_suppkey:sym), i32);
    t120:f64 = check_cast(@column_value(t114,`l_extendedprice:sym), f64);
    t121:f64 = check_cast(@column_value(t114,`l_discount:sym), f64);
    t125:date = check_cast(@column_value(t114,`l_shipdate:sym), date);
    t131:? = @geq(t125,1995-01-01:date);
    t132:? = @leq(t125,1996-12-31:date);
    t133:? = @and(t131,t132);
    t134:? = @fetch(t115);
    t150:? = @compress(t133,t134);
    //t134:? = @compress(t133,t115);
    t136:? = @compress(t133,t117);
    t139:? = @compress(t133,t120);
    t140:? = @compress(t133,t121);
    t144:? = @compress(t133,t125);
    //t150:? = @fetch(t134);
    t151:? = @join_index(@eq,t105,t150);
    t152:? = @index(t151,0:i64);
    t153:? = @index(t151,1:i64);
    t155:? = @index(t90,t152);
    t158:? = @index(t93,t152);
    t159:? = @index(t94,t152);
    t181:? = @index(t136,t153);
    t184:? = @index(t139,t153);
    t185:? = @index(t140,t153);
    t189:? = @index(t144,t153);
    t195:? = @fetch(t4);
    t196:? = @list(t195,t1);
    t197:? = @list(t158,t181);
    t198:? = @join_index(@eq,t196,t197);
    t200:? = @index(t198,1:i64);
    t209:? = @index(t155,t200);
    t213:? = @index(t159,t200);
    t238:? = @index(t184,t200);
    t239:? = @index(t185,t200);
    t243:? = @index(t189,t200);
    t249:? = @date_year(t243);
    t250:? = @minus(1:i32,t239);
    t251:? = @mul(t238,t250);
    t252:? = @list(t213,t209,t249);
    t253:? = @group(t252);
    t254:? = @keys(t253);
    t255:? = @values(t253);
    t256:? = @index(t213,t254);
    t257:? = @index(t209,t254);
    t258:? = @index(t249,t254);
    t259:? = @each_right(@index,t251,t255);
    t260:? = @each(@sum,t259);
    t261:? = @raze(t260);
    t262:? = @list(t256,t257,t258);
    t263:? = @order(t262,(1,1,1):bool);
    t264:? = @index(t256,t263);
    t265:? = @index(t257,t263);
    t266:? = @index(t258,t263);
    t267:? = @index(t261,t263);
    t268:? = (`supp_nation,`cust_nation,`l_year,`revenue):sym;
    t269:? = @list(t264,t265,t266,t267);
    t270:? = @table(t268,t269);
    return t270;
  }
}
// Program slicing (before 277, after 116)
// Elapsed time: 8.30 ms
