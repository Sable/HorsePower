# TPC-H Query 6

## Table info

```
  CREATE TABLE LINEITEM ( L_ORDERKEY        INTEGER NOT NULL,
                          L_PARTKEY         INTEGER NOT NULL,
                          L_SUPPKEY         INTEGER NOT NULL,
                          L_LINENUMBER      INTEGER NOT NULL,
                          L_QUANTITY        DECIMAL(15,2) NOT NULL,
                          L_EXTENDEDPRICE   DECIMAL(15,2) NOT NULL,
                          L_DISCOUNT        DECIMAL(15,2) NOT NULL,
                          L_TAX             DECIMAL(15,2) NOT NULL,
                          L_RETURNFLAG      CHAR(1) NOT NULL,
                          L_LINESTATUS      CHAR(1) NOT NULL,
                          L_SHIPDATE        DATE NOT NULL,
                          L_COMMITDATE      DATE NOT NULL,
                          L_RECEIPTDATE     DATE NOT NULL,
                          L_SHIPINSTRUCT    CHAR(25) NOT NULL,
                          L_SHIPMODE        CHAR(10) NOT NULL,
                          L_COMMENT         VARCHAR(44) NOT NULL);
```

## SQL 

```sql
  select
    sum(l_extendedprice * l_discount) as revenue
  from
    lineitem
  where
    l_shipdate >= date '1994-01-01'
    and l_shipdate < date '1994-01-01' + interval '1' year
    and l_discount between .06 - 0.01 and .06 + 0.01
    and l_quantity < 24; 
```

## HorseIR

```
// l_extendedprice DECIMAL(15,2) f64
// l_discount      DECIMAL(15,2) f64
// l_shipdate      DATE          d
// l_quantity      DECIMAL(15,2) f64


module default{
    import Builtin;
    def main() : table {
        t0:f64        = check_cast(@column_value(`lineitem, `l_extendedprice), f64);
        t1:f64        = check_cast(@column_value(`lineitem, `l_discount     ), f64);
        t2:d          = check_cast(@column_value(`lineitem, `l_shipdate     ), d  );
        t3:f64        = check_cast(@column_value(`lineitem, `l_quantity     ), f64);

        t4:bool       = @geq(t2, 1994.01.01d);
        t5:d          = @datetime_add(1994.01.01d, 1:i64, `year);
        t6:bool       = @lt(t2, t5);
        t7:f64        = @minus(0.06, 0.01);
        t8:f64        = @plus(0.06, 0.01);

        t9:bool       = @gt(t1,t7);
        t10:bool      = @lt(t1,t8);
        t11:bool      = @and(t9,t10);
        t12:bool      = @lt(t3, 24:i64);

        t13:bool      = @and(t4,t6);
        t14:bool      = @and(t13,t9);
        t15:bool      = @and(t14,t12);

        t16:f64       = @compress(t15,t0);
        t17:f64       = @compress(t15,t1);
        t18:f64       = @mul(t16, t17);
        t19:f64       = @sum(t18);

        t20:list<sym> = @tolist(`revenue);
        t21:list<f64> = @enlist(t19);
        t22:table     = @table(t20,t21);
        return t22;
    }
}
```


