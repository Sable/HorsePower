{
   "operator":"project",
   "input":{
      "operator":"project",
      "input":{
         "operator":"groupby",
         "input":{
            "operator":"project",
            "input":{
               "operator":"join",
               "input":[
                  {
                     "operator":"select",
                     "input":{
                        "operator":"table",
                        "table":{
                           "id":[
                              "sys",
                              "lineitem"
                           ]
                        },
                        "columns":[
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "lineitem",
                                    "l_partkey"
                                 ]
                              }
                           },
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "lineitem",
                                    "l_extendedprice"
                                 ]
                              }
                           },
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "lineitem",
                                    "l_discount"
                                 ]
                              }
                           },
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "lineitem",
                                    "l_shipdate"
                                 ]
                              }
                           }
                        ]
                     },
                     "conditions":[
                        [
                           {
                              "type":"date",
                              "value":"1995-09-01"
                           },
                           {
                              "type":"binary_op",
                              "value":"<="
                           },
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "lineitem",
                                    "l_shipdate"
                                 ]
                              }
                           },
                           {
                              "type":"binary_op",
                              "value":"<"
                           },
                           {
                              "type":"expr",
                              "value":{
                                 "function":{
                                    "id":[
                                       "sys",
                                       "sql_add"
                                    ]
                                 },
                                 "args":[
                                    {
                                       "type":"date",
                                       "value":"1995-09-01"
                                    },
                                    {
                                       "type":"month_interval",
                                       "value":"1"
                                    }
                                 ]
                              }
                           }
                        ]
                     ]
                  },
                  {
                     "operator":"table",
                     "table":{
                        "id":[
                           "sys",
                           "part"
                        ]
                     },
                     "columns":[
                        {
                           "isNull":"notnull",
                           "property":"hashcol",
                           "type":"name",
                           "value":{
                              "id":[
                                 "part",
                                 "p_partkey"
                              ]
                           }
                        },
                        {
                           "isNull":"notnull",
                           "type":"name",
                           "value":{
                              "id":[
                                 "part",
                                 "p_type"
                              ]
                           }
                        }
                     ]
                  }
               ],
               "condition":[
                  {
                     "isNull":"notnull",
                     "type":"name",
                     "value":{
                        "id":[
                           "lineitem",
                           "l_partkey"
                        ]
                     }
                  },
                  {
                     "type":"binary_op",
                     "value":"="
                  },
                  {
                     "isNull":"notnull",
                     "property":"hashcol",
                     "type":"name",
                     "value":{
                        "id":[
                           "part",
                           "p_partkey"
                        ]
                     }
                  }
               ]
            },
            "output":[
               [
                  {
                     "isNull":"notnull",
                     "type":"name",
                     "value":{
                        "id":[
                           "lineitem",
                           "l_extendedprice"
                        ]
                     }
                  }
               ],
               [
                  {
                     "isNull":"notnull",
                     "type":"name",
                     "value":{
                        "id":[
                           "lineitem",
                           "l_discount"
                        ]
                     }
                  }
               ],
               [
                  {
                     "isNull":"notnull",
                     "type":"name",
                     "value":{
                        "id":[
                           "part",
                           "p_type"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"expr",
                     "value":{
                        "function":{
                           "id":[
                              "sys",
                              "like"
                           ]
                        },
                        "args":[
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "part",
                                    "p_type"
                                 ]
                              }
                           },
                           {
                              "type":"char",
                              "value":"PROMO%"
                           }
                        ]
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L12",
                           "L12"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"expr",
                     "value":{
                        "function":{
                           "id":[
                              "sys",
                              "isnull"
                           ]
                        },
                        "args":[
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L12",
                                    "L12"
                                 ]
                              }
                           }
                        ]
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L13",
                           "L13"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"decimal",
                     "value":{
                        "isNull":"notnull",
                        "type":"name",
                        "value":{
                           "id":[
                              "lineitem",
                              "l_extendedprice"
                           ]
                        }
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L14",
                           "L14"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"expr",
                     "value":{
                        "function":{
                           "id":[
                              "sys",
                              "sql_sub"
                           ]
                        },
                        "args":[
                           {
                              "type":"decimal",
                              "value":{
                                 "type":"tinyint",
                                 "value":"1"
                              }
                           },
                           {
                              "isNull":"notnull",
                              "type":"name",
                              "value":{
                                 "id":[
                                    "lineitem",
                                    "l_discount"
                                 ]
                              }
                           }
                        ]
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L15",
                           "L15"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"expr",
                     "value":{
                        "function":{
                           "id":[
                              "sys",
                              "ifthenelse"
                           ]
                        },
                        "args":[
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L13",
                                    "L13"
                                 ]
                              }
                           },
                           {
                              "type":"boolean",
                              "value":"false"
                           },
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L12",
                                    "L12"
                                 ]
                              }
                           }
                        ]
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L16",
                           "L16"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"expr",
                     "value":{
                        "function":{
                           "id":[
                              "sys",
                              "sql_mul"
                           ]
                        },
                        "args":[
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L14",
                                    "L14"
                                 ]
                              }
                           },
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L15",
                                    "L15"
                                 ]
                              }
                           }
                        ]
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L17",
                           "L17"
                        ]
                     }
                  }
               ],
               [
                  {
                     "type":"expr",
                     "value":{
                        "function":{
                           "id":[
                              "sys",
                              "ifthenelse"
                           ]
                        },
                        "args":[
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L16",
                                    "L16"
                                 ]
                              }
                           },
                           {
                              "type":"name",
                              "value":{
                                 "id":[
                                    "L17",
                                    "L17"
                                 ]
                              }
                           },
                           {
                              "type":"decimal",
                              "value":{
                                 "type":"tinyint",
                                 "value":"0"
                              }
                           }
                        ]
                     }
                  },
                  {
                     "type":"as",
                     "value":{
                        "id":[
                           "L20",
                           "L20"
                        ]
                     }
                  }
               ]
            ]
         },
         "block2":[
            [
               {
                  "type":"expr",
                  "value":{
                     "function":{
                        "id":[
                           "sys",
                           "sum"
                        ]
                     },
                     "args":[
                        {
                           "type":"name",
                           "value":{
                              "id":[
                                 "L20",
                                 "L20"
                              ]
                           }
                        }
                     ]
                  }
               },
               {
                  "type":"as",
                  "value":{
                     "id":[
                        "L3",
                        "L3"
                     ]
                  }
               }
            ],
            [
               {
                  "type":"expr",
                  "value":{
                     "function":{
                        "id":[
                           "sys",
                           "sum"
                        ]
                     },
                     "args":[
                        {
                           "type":"name",
                           "value":{
                              "id":[
                                 "L17",
                                 "L17"
                              ]
                           }
                        }
                     ]
                  }
               },
               {
                  "type":"as",
                  "value":{
                     "id":[
                        "L4",
                        "L4"
                     ]
                  }
               }
            ]
         ],
         "block1":[

         ]
      },
      "output":[
         [
            {
               "type":"decimal",
               "value":{
                  "type":"expr",
                  "value":{
                     "function":{
                        "id":[
                           "sys",
                           "sql_mul"
                        ]
                     },
                     "args":[
                        {
                           "type":"string",
                           "value":"L3"
                        },
                        {
                           "type":"decimal",
                           "value":"1000"
                        }
                     ]
                  }
               }
            },
            {
               "type":"as",
               "value":{
                  "id":[
                     "L7",
                     "L7"
                  ]
               }
            }
         ],
         [
            {
               "type":"expr",
               "value":{
                  "function":{
                     "id":[
                        "sys",
                        "sql_div"
                     ]
                  },
                  "args":[
                     {
                        "type":"name",
                        "value":{
                           "id":[
                              "L7",
                              "L7"
                           ]
                        }
                     },
                     {
                        "type":"string",
                        "value":"L4"
                     }
                  ]
               }
            },
            {
               "type":"as",
               "value":{
                  "id":[
                     "L5",
                     "promo_revenue"
                  ]
               }
            }
         ]
      ]
   },
   "output":[
      [
         {
            "type":"name",
            "value":{
               "id":[
                  "L5",
                  "promo_revenue"
               ]
            }
         }
      ]
   ]
}
